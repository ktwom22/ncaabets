<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}Edge Engine Pro | Elite Analytics{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050708; --card-bg: #111418; --primary: #3b82f6; --accent: #fbbf24;
            --text-main: #ffffff; --text-dim: #a1a1aa; --border: #27272a; --success: #22c55e;
        }
        [data-theme="light"] {
            --bg: #f4f4f5; --card-bg: #ffffff; --primary: #2563eb; --accent: #d97706;
            --text-main: #09090b; --text-dim: #71717a; --border: #e4e4e7; --success: #16a34a;
        }

        body {
            background: var(--bg);
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
            transition: background 0.3s ease;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* --- NAVIGATION --- */
        .nav-header {
            border-bottom: 1px solid var(--border);
            background: var(--card-bg);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .fw-black { font-weight: 900; }
        .stat-label { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; font-weight: 800; letter-spacing: 1px; }

        /* --- NEURAL SYNC BAR --- */
        #sync-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: var(--primary);
            width: 0%;
            z-index: 2000;
            transition: width 0.4s ease;
            box-shadow: 0 0 10px var(--primary);
        }

        /* --- THEME SWITCH --- */
        .theme-switch { position: relative; display: inline-block; width: 40px; height: 20px; }
        .theme-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #3f3f46; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* --- MOBILE RESPONSIVENESS --- */
        @media (max-width: 768px) {
            .container { padding-left: 15px; padding-right: 15px; }
            .nav-header h1 { font-size: 1.1rem; }
            .stat-label { font-size: 0.55rem; }
            body { padding-bottom: 60px; } /* Space for thumb-scrolling */
        }

        /* Prevent image breaking layout */
        img { max-width: 100%; height: auto; }

        {% block extra_css %}{% endblock %}
    </style>
</head>
<body>

<div id="sync-progress"></div>

<nav class="nav-header mb-4">
    <div class="container d-flex justify-content-between align-items-center">
        <a href="/" class="text-decoration-none">
            <h1 class="h4 fw-black m-0 text-main" style="letter-spacing: -1.5px;">
                EDGE <span class="text-primary">PRO</span>
            </h1>
        </a>
        <div class="d-flex align-items-center gap-3">
            <div class="d-none d-sm-block">
                <span class="stat-label">Neural Sync Active</span>
            </div>
            <label class="theme-switch">
                <input type="checkbox" id="theme-toggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>
</nav>

<main>
    {% block content %}{% endblock %}
</main>

<script>
    // Theme Engine
    const themeToggle = document.getElementById('theme-toggle');
    const applyTheme = (theme) => {
        document.body.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        if (themeToggle) themeToggle.checked = (theme === 'light');
    };

    if (themeToggle) {
        themeToggle.addEventListener('change', () => {
            applyTheme(themeToggle.checked ? 'light' : 'dark');
        });
    }

    // Initialize Theme immediately to prevent flash
    const savedTheme = localStorage.getItem('theme') || 'dark';
    applyTheme(savedTheme);

    // Neural Sync Progress Bar Simulation (Matches your 60s refresh)
    let progress = 0;
    const progressBar = document.getElementById('sync-progress');
    setInterval(() => {
        progress += 1.67; // Approx 100/60
        if (progress > 100) progress = 0;
        progressBar.style.width = progress + "%";
    }, 1000);
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>