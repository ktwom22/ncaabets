{% extends "base.html" %}

{% block title %}Edge Engine Pro | Dashboard{% endblock %}

{% block extra_css %}
<style>
    :root {
        --card-border-heavy: #0f172a;
        --highlight-bg: rgba(59, 130, 246, 0.08);
    }

    [data-theme="dark"] {
        --card-border-heavy: #000000;
        --highlight-bg: rgba(59, 130, 246, 0.15);
    }

    .game-card {
        background: var(--card-bg);
        border: 2.5px solid var(--card-border-heavy) !important;
        border-radius: 20px;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: transform 0.2s ease;
    }

    .card-meta-header {
        padding: 12px 16px;
        background: var(--inner-lift);
        border-bottom: 2.5px solid var(--card-border-heavy);
        display: flex;
        justify-content: space-between;
    }

    .card-body-main { padding: 20px 15px; text-align: center; }

    /* --- THE DATA WELL --- */
    .data-well {
        margin: 15px 0;
        display: grid;
        grid-template-columns: 1fr 40px 1fr;
        align-items: center;
        background: var(--inner-lift);
        border: 2px solid var(--card-border-heavy);
        border-radius: 16px;
        overflow: hidden; /* Clips the highlight background */
    }

    /* Team Side Styling */
    .team-side {
        padding: 20px 10px;
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    /* THE HIGHLIGHT: This triggers if it's the picked team */
    .is-pick {
        background: var(--highlight-bg);
        box-shadow: inset 0 0 15px rgba(59, 130, 246, 0.2);
    }

    .pick-badge {
        font-size: 0.5rem;
        background: var(--primary);
        color: white;
        padding: 2px 8px;
        border-radius: 10px;
        margin-bottom: 5px;
        font-weight: 900;
        text-transform: uppercase;
    }

    .v-divider {
        border-left: 2px solid var(--card-border-heavy);
        height: 100%;
        width: 100%;
    }

    /* Logo Size Increase */
    .logo-large {
        width: 52px;
        height: 52px;
        object-fit: contain;
        margin-bottom: 8px;
        /* Slight drop shadow to make logos pop */
        filter: drop-shadow(0 4px 4px rgba(0,0,0,0.2));
    }

    .card-footer-action {
        margin-top: auto;
        padding: 15px;
        background: var(--inner-lift);
        border-top: 2.5px solid var(--card-border-heavy);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .caps-bold { font-size: 0.65rem; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; }
</style>
{% endblock %}

{% block content %}
<div class="row g-4 mt-2">
    {% for g in games %}
    <div class="col-md-6 col-lg-4">
        <div class="game-card" onclick="window.location.href='/matchup/{{ g.slug }}'">

            <div class="card-meta-header">
                <span class="caps-bold" style="color: var(--primary);">MODEL RATING: {{ g.Edge }}</span>
                <span class="caps-bold {{ 'text-warning' if g.is_locked else 'text-danger' }}">
                    {% if g.is_locked %}LOCKED{% else %}‚óè LIVE{% endif %}
                </span>
            </div>

            <div class="card-body-main">
                <div class="caps-bold opacity-75 mb-1" style="color: var(--text-dim);">SYSTEM RECOMMENDATION</div>
                <h4 class="fw-black mb-3">{{ g.Pick }} <span class="text-primary">{{ g.Pick_Spread }}</span></h4>

                <div class="data-well">
                    <div class="team-side {{ 'is-pick' if g.Pick == g.Left_Team }}">
                        {% if g.Pick == g.Left_Team %}<span class="pick-badge">THE PICK</span>{% endif %}
                        <img src="{{ g.L_Logo }}" class="logo-large" onerror="this.src='https://a.espncdn.com/combiner/i?img=/i/teamlogos/ncaa/500/default.png'">
                        <div class="fw-black">{{ g.Left_Proj }}</div>
                    </div>

                    <div class="v-divider"></div>

                    <div class="team-side {{ 'is-pick' if g.Pick == g.Right_Team }}">
                        {% if g.Pick == g.Right_Team %}<span class="pick-badge">THE PICK</span>{% endif %}
                        <img src="{{ g.R_Logo }}" class="logo-large" onerror="this.src='https://a.espncdn.com/combiner/i?img=/i/teamlogos/ncaa/500/default.png'">
                        <div class="fw-black text-primary">{{ g.Right_Proj }}</div>
                    </div>
                </div>

                <div class="badge bg-dark border border-secondary px-4 py-2" style="font-family: monospace;">
                    LIVE: {{ g.Live_Score }}
                </div>
            </div>

            <div class="card-footer-action">
                <div>
                    <span class="caps-bold d-block" style="font-size: 0.55rem; color: var(--text-dim);">VALUE ADVANTAGE</span>
                    <span class="fw-black text-success h5 mb-0">+{{ g.Edge }}%</span>
                </div>
                <div class="btn btn-sm btn-dark rounded-pill px-4 fw-black" style="font-size: 0.7rem; border: 2px solid var(--card-border-heavy);">
                    VIEW INTEL
                </div>
            </div>

        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}